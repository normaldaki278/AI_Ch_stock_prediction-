# AI Stock Prediction Project

На первых этапах проекта работали с моделями предсказания котировок акций. 
На третьем этапе занимаемся NLP и интерпретации предыдущих решений.
Для работы с файлами третьей части проекта стоит прочитать первый пункт после описания структуры файлов.

## Структура проекта

- **`data/`** — Папка с датасетами:
  - `final_data.txt` — Финальные данные, использованные для предсказания котировок.
  - `news_sentiment_dataset.cs.csv` — Датасет с новостями и их разметкой по тональности для вкладки бота "Новостной анализ"
  - `news_dataset_for_gigachat.csv` - Датасет для работы с GigaChat. Новости с тегами для подачи в RAG, потом в модель.

- **`gigachat_interpretation/`** — Папка с кодом для интерпретации новостей от GigaChat:
  - `gigachat_response.ipynb` — Ноутбук с функциями ответа GigaChat для бота
  - `rag.ipynb` — Ноутбук с функциями RAG для бота
  - `rag_analyse_and_tests.ipynb` - ноутбук с тестом разметок Rag и анализом как работает
  - `parser.ipynb` - Ноутбук с парсером новостей с тегами

- **`news_analysis/`** — Папка с кодом для анализа новостей:
  - `news_sentiment_analysis.ipynb` — Ноутбук с анализом тональности новостей. Этот код анализирует новостные заголовки, используя BERT, для определения их влияния на котировки.

- **`prediction_model/`** — Папка с кодом модели для предсказания котировок:
  - `prediction_model.ipynb` — Ноутбук с кодом для предсказания изменения котировок акций на основе исторических данных и новостей.

- **`tg_bot/`** — Папка с кодом для Telegram-бота:

## Как использовать

### 1. Интерпретация новостей с GigaChat
- Используйте функции из папки `gigachat_interpretation` для обращения к парсеру, RAG, GigaChat для получения интерпретации от модели.

Датасет с новостями и разметкой тегов, на котором проводили тесты gigachat - `data/news_dataset_for_gigachat.csv`

Описание функций:
В `gigachat_response.ipynb`:
- sys_prompt1_func принимает информацию о запросе и составляет первый системный промпт
- sys_prompt2_func принимает информацию о запросе и предыдущий ответ и выдает второй системный промпт
- get_responses принимает информацию о запросе и с использованием первых двух функций выдает итоговый ответ от gigachat
  
Для получения интерпретации отрывков новостей от GigaChat необходимо подать в функцию get_responses() название компании, текущую дату, новости, уровень пользователя. На выходе будет текст ответа.

В `rag.ipynb`:
- функция принимает новые новости и добавляет в векторную базу данных
- функция поиска лучших отрывков по запросу компании


# Архитектура Поиска релевантных новостей:
![image](https://github.com/user-attachments/assets/cc7e287c-5e85-409d-b442-d2159f203a4f)
# Архитектура интеграции GigaChat
![image](https://github.com/user-attachments/assets/aca834b1-dc44-45b8-8760-af62cb60aeaa)




### 2. Анализ новостей
- Откройте и выполните ноутбук `news_analysis/news_sentiment_analysis.ipynb` для анализа новостей. Этот ноутбук использует модель BERT для анализа тональности новостей, чтобы оценить их влияние на движение котировок.

### 3. Модель предсказания котировок
- Откройте ноутбук `prediction_model/prediction_model.ipynb`, чтобы запустить модель предсказания котировок. Эта модель обучена на исторических данных и результатах анализа новостей и прогнозирует будущие изменения цен на акции.

### 4. Telegram-бот
- Откройте ноутбук `tg_bot/tg_bot.ipynb`, чтобы настроить и запустить Telegram-бота. Бот предоставляет информацию о текущих котировках акций, прогнозирует будущие цены, анализирует новости и предоставляет графики в реальном времени.
- **Ссылка на бота**: [Sber AI Case Bot](https://t.me/Sber_ai_case_bot)



## Streamlit приложение
Попробуйте наше интерактивное приложение на [Streamlit](http://5.253.62.232:8501/), которое предоставляет прогнозы котировок акций на основе новостей и исторических данных.

## Датасеты
- **news_dataset_for_gigachat.csv** - Датасет новостей для работы с GigaChat
- **news_sentiment_dataset.cs.csv** — Датасет с новостями и их тональностью, который используется для анализа влияния новостей на котировки.
- **final_data.txt** — Финальный датасет с историческими данными о котировках, использованный для обучения и тестирования модели.
